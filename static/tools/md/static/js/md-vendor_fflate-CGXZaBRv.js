var F=Uint8Array,U=Uint16Array,lr=Int32Array,wr=new F([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),hr=new F([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gr=new F([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),yr=function(r,a){for(var f=new U(31),v=0;v<31;++v)f[v]=a+=1<<r[v-1];for(var e=new lr(f[30]),v=1;v<30;++v)for(var n=f[v];n<f[v+1];++n)e[n]=n-f[v]<<5|v;return{b:f,r:e}},kr=yr(wr,2),qr=kr.b,er=kr.r;qr[28]=258,er[258]=28;var zr=yr(hr,0),Mr=zr.r,nr=new U(32768);for(var u=0;u<32768;++u){var P=(u&43690)>>1|(u&21845)<<1;P=(P&52428)>>2|(P&13107)<<2,P=(P&61680)>>4|(P&3855)<<4,nr[u]=((P&65280)>>8|(P&255)<<8)>>1}var j=(function(r,a,f){for(var v=r.length,e=0,n=new U(a);e<v;++e)r[e]&&++n[r[e]-1];var h=new U(a);for(e=1;e<a;++e)h[e]=h[e-1]+n[e-1]<<1;var t;if(f){t=new U(1<<a);var c=15-a;for(e=0;e<v;++e)if(r[e])for(var M=e<<4|r[e],l=a-r[e],y=h[r[e]-1]++<<l,q=y|(1<<l)-1;y<=q;++y)t[nr[y]>>c]=M}else for(t=new U(v),e=0;e<v;++e)r[e]&&(t[e]=nr[h[r[e]-1]++]>>15-r[e]);return t}),V=new F(288);for(var u=0;u<144;++u)V[u]=8;for(var u=144;u<256;++u)V[u]=9;for(var u=256;u<280;++u)V[u]=7;for(var u=280;u<288;++u)V[u]=8;var m=new F(32);for(var u=0;u<32;++u)m[u]=5;var Ir=j(V,9,0),xr=j(m,5,0),Ar=function(r){return(r+7)/8|0},Br=function(r,a,f){return(f==null||f>r.length)&&(f=r.length),new F(r.subarray(a,f))},L=function(r,a,f){f<<=a&7;var v=a/8|0;r[v]|=f,r[v+1]|=f>>8},b=function(r,a,f){f<<=a&7;var v=a/8|0;r[v]|=f,r[v+1]|=f>>8,r[v+2]|=f>>16},vr=function(r,a){for(var f=[],v=0;v<r.length;++v)r[v]&&f.push({s:v,f:r[v]});var e=f.length,n=f.slice();if(!e)return{t:Sr,l:0};if(e==1){var h=new F(f[0].s+1);return h[f[0].s]=1,{t:h,l:1}}f.sort(function(z,B){return z.f-B.f}),f.push({s:-1,f:25001});var t=f[0],c=f[1],M=0,l=1,y=2;for(f[0]={s:-1,f:t.f+c.f,l:t,r:c};l!=e-1;)t=f[f[M].f<f[y].f?M++:y++],c=f[M!=l&&f[M].f<f[y].f?M++:y++],f[l++]={s:-1,f:t.f+c.f,l:t,r:c};for(var q=n[0].s,v=1;v<e;++v)n[v].s>q&&(q=n[v].s);var k=new U(q+1),I=fr(f[l-1],k,0);if(I>a){var v=0,i=0,N=I-a,Q=1<<N;for(n.sort(function(B,A){return k[A.s]-k[B.s]||B.f-A.f});v<e;++v){var K=n[v].s;if(k[K]>a)i+=Q-(1<<I-k[K]),k[K]=a;else break}for(i>>=N;i>0;){var R=n[v].s;k[R]<a?i-=1<<a-k[R]++-1:++v}for(;v>=0&&i;--v){var x=n[v].s;k[x]==a&&(--k[x],++i)}I=a}return{t:new F(k),l:I}},fr=function(r,a,f){return r.s==-1?Math.max(fr(r.l,a,f+1),fr(r.r,a,f+1)):a[r.s]=f},ir=function(r){for(var a=r.length;a&&!r[--a];);for(var f=new U(++a),v=0,e=r[0],n=1,h=function(c){f[v++]=c},t=1;t<=a;++t)if(r[t]==e&&t!=a)++n;else{if(!e&&n>2){for(;n>138;n-=138)h(32754);n>2&&(h(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(h(e),--n;n>6;n-=6)h(8304);n>2&&(h(n-3<<5|8208),n=0)}for(;n--;)h(e);n=1,e=r[t]}return{c:f.subarray(0,v),n:a}},_=function(r,a){for(var f=0,v=0;v<a.length;++v)f+=r[v]*a[v];return f},Tr=function(r,a,f){var v=f.length,e=Ar(a+2);r[e]=v&255,r[e+1]=v>>8,r[e+2]=r[e]^255,r[e+3]=r[e+1]^255;for(var n=0;n<v;++n)r[e+n+4]=f[n];return(e+4+v)*8},sr=function(r,a,f,v,e,n,h,t,c,M,l){L(a,l++,f),++e[256];for(var y=vr(e,15),q=y.t,k=y.l,I=vr(n,15),i=I.t,N=I.l,Q=ir(q),K=Q.c,R=Q.n,x=ir(i),z=x.c,B=x.n,A=new U(19),o=0;o<K.length;++o)++A[K[o]&31];for(var o=0;o<z.length;++o)++A[z[o]&31];for(var w=vr(A,7),T=w.t,W=w.l,S=19;S>4&&!T[gr[S-1]];--S);var X=M+5<<3,C=_(e,V)+_(n,m)+h,D=_(e,q)+_(n,i)+h+14+3*S+_(A,T)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&X<=C&&X<=D)return Tr(a,l,r.subarray(c,c+M));var G,g,E,O;if(L(a,l,1+(D<C)),l+=2,D<C){G=j(q,k,0),g=q,E=j(i,N,0),O=i;var p=j(T,W,0);L(a,l,R-257),L(a,l+5,B-1),L(a,l+10,S-4),l+=14;for(var o=0;o<S;++o)L(a,l+3*o,T[gr[o]]);l+=3*S;for(var H=[K,z],$=0;$<2;++$)for(var Y=H[$],o=0;o<Y.length;++o){var J=Y[o]&31;L(a,l,p[J]),l+=T[J],J>15&&(L(a,l,Y[o]>>5&127),l+=Y[o]>>12)}}else G=Ir,g=V,E=xr,O=m;for(var o=0;o<t;++o){var s=v[o];if(s>255){var J=s>>18&31;b(a,l,G[J+257]),l+=g[J+257],J>7&&(L(a,l,s>>23&31),l+=wr[J]);var Z=s&31;b(a,l,E[Z]),l+=O[Z],Z>3&&(b(a,l,s>>5&8191),l+=hr[Z])}else b(a,l,G[s]),l+=g[s]}return b(a,l,G[256]),l+g[256]},Cr=new lr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Sr=new F(0),Dr=function(r,a,f,v,e,n){var h=n.z||r.length,t=new F(v+h+5*(1+Math.ceil(h/7e3))+e),c=t.subarray(v,t.length-e),M=n.l,l=(n.r||0)&7;if(a){l&&(c[0]=n.r>>3);for(var y=Cr[a-1],q=y>>13,k=y&8191,I=(1<<f)-1,i=n.p||new U(32768),N=n.h||new U(I+1),Q=Math.ceil(f/3),K=2*Q,R=function(ar){return(r[ar]^r[ar+1]<<Q^r[ar+2]<<K)&I},x=new lr(25e3),z=new U(288),B=new U(32),A=0,o=0,w=n.i||0,T=0,W=n.w||0,S=0;w+2<h;++w){var X=R(w),C=w&32767,D=N[X];if(i[C]=D,N[X]=C,W<=w){var G=h-w;if((A>7e3||T>24576)&&(G>423||!M)){l=sr(r,c,0,x,z,B,o,T,S,w-S,l),T=A=o=0,S=w;for(var g=0;g<286;++g)z[g]=0;for(var g=0;g<30;++g)B[g]=0}var E=2,O=0,p=k,H=C-D&32767;if(G>2&&X==R(w-H))for(var $=Math.min(q,G)-1,Y=Math.min(32767,w),J=Math.min(258,G);H<=Y&&--p&&C!=D;){if(r[w+E]==r[w+E-H]){for(var s=0;s<J&&r[w+s]==r[w+s-H];++s);if(s>E){if(E=s,O=H,s>$)break;for(var Z=Math.min(H,s-2),or=0,g=0;g<Z;++g){var d=w-H+g&32767,Ur=i[d],ur=d-Ur&32767;ur>or&&(or=ur,D=d)}}}C=D,D=i[C],H+=C-D&32767}if(O){x[T++]=268435456|er[E]<<18|Mr[O];var tr=er[E]&31,cr=Mr[O]&31;o+=wr[tr]+hr[cr],++z[257+tr],++B[cr],W=w+E,++A}else x[T++]=r[w],++z[r[w]]}}for(w=Math.max(w,W);w<h;++w)x[T++]=r[w],++z[r[w]];l=sr(r,c,M,x,z,B,o,T,S,w-S,l),M||(n.r=l&7|c[l/8|0]<<3,l-=7,n.h=N,n.p=i,n.i=w,n.w=W)}else{for(var w=n.w||0;w<h+M;w+=65535){var rr=w+65535;rr>=h&&(c[l/8|0]=M,rr=h),l=Tr(c,l+1,r.subarray(w,rr))}n.i=h}return Br(t,0,v+Ar(l)+e)},Er=function(r,a,f,v,e){if(!e&&(e={l:1},a.dictionary)){var n=a.dictionary.subarray(-32768),h=new F(n.length+r.length);h.set(n),h.set(r,n.length),r=h,e.w=n.length}return Dr(r,a.level==null?6:a.level,a.mem==null?e.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+a.mem,f,v,e)};function Hr(r,a){return Er(r,a||{},0,0)}var Fr=typeof TextDecoder<"u"&&new TextDecoder,Gr=0;try{Fr.decode(Sr,{stream:!0}),Gr=1}catch{}export{Hr as d};
