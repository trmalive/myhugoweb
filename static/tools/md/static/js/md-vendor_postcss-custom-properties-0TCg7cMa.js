import{p as C,h as I,a as k}from"./md-vendor_npm_csstools-BaE1dLUc.js";import{a as m}from"./md-vendor_postcss-value-parser-PJ4hW_c9.js";const F=C("csstools-implicit-layer")[0];function P(e){const t=new Map,n=new Map,s=[];e.walkAtRules(o=>{if(o.name.toLowerCase()!=="layer")return;{let i=o.parent;for(;i;){if(i.type!=="atrule"||i.name.toLowerCase()!=="layer"){if(i===o.root())break;return}i=i.parent}}let c;if(o.nodes)c=R(o.params,1);else{if(!o.params.trim())return;c=o.params}let l=C(c);if(l?.length){{let i=o.parent;for(;i&&i.type==="atrule"&&i.name.toLowerCase()==="layer";){const a=n.get(i);a&&(l=l.map(u=>a.concat(u))),i=i.parent}}if(k(s,l),o.nodes){const i=l[0].concat(F);t.set(o,i),n.set(o,l[0])}}});for(const o of t.values())k(s,[o]);const r=new WeakMap;for(const[o,c]of t)r.set(o,s.findIndex(l=>c.equal(l)));return r}function R(e,t){return e.trim()?e:"csstools-anon-layer--"+t++}const $=/(?:!\s*)?postcss-custom-properties:\s*off\b/i,h=new WeakMap;function M(e){if(!e||!e.nodes)return!1;if(h.has(e))return h.get(e);const t=e.some(n=>A(n,$));return h.set(e,t),t}const N=/(?:!\s*)?postcss-custom-properties:\s*ignore\s+next\b/i;function y(e){return!!e&&(!!M(e.parent)||A(e.prev(),N))}function A(e,t){return!!e&&e.type==="comment"&&t.test(e.text)}const T=new Set(["layer"]);function z(e){let t=e.parent;for(;t;){if(t.type==="atrule"&&!T.has(t.name.toLowerCase()))return!1;t=t.parent}return!0}const j=/^html$/i,B=/^:where\(html\)$/i,D=/^:root$/i,V=/^:where\(:root\)$/i,W=/(html|:root)/i,H=/^var$/i;function w(e){return e.type==="function"&&H.test(e.value)&&e.nodes?.length>0}const J=/\bvar\(/i;function b(e,t){let n=t.get(e);return n||(n=m(e),t.set(e,n),n)}function q(e,t){let n=e.length;const s=new Array(n),r={};let o=n;const c=x(t),l=S(e);for(;o--;)r[o]||i(e[o],o,new Set);return s;function i(a,u,f){if(f.has(a)){let p;try{p=", node was:"+JSON.stringify(a)}catch{p=""}throw new Error("Cyclic dependency"+p)}if(!l.has(a))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(a));if(r[u])return;r[u]=!0;const d=Array.from(c.get(a)||new Set);if(u=d.length){f.add(a);do{const p=d[--u];i(p,l.get(p),f)}while(u);f.delete(a)}s[--n]=a}}function U(e,t){const n=new Set;for(;e.size>0;){const s=G(Array.from(e.keys()),t);if(!s)return n;e.delete(s),n.add(s),t=t.filter(r=>r.indexOf(s)===-1)}return n}function G(e,t){let n=e.length;const s=new Array(n),r={};let o=n;const c=x(t),l=S(e);for(;o--;)if(!r[o]){const a=i(e[o],o,new Set);if(!a)continue;return a}function i(a,u,f){if(f.has(a))return a;if(!l.has(a)||r[u])return;r[u]=!0;const d=Array.from(c.get(a)||new Set);if(u=d.length){f.add(a);do{const p=d[--u],g=i(p,l.get(p),f);if(g)return g}while(u);f.delete(a)}s[--n]=a}}function x(e){const t=new Map;for(let n=0,s=e.length;n<s;n++){const r=e[n];t.has(r[0])||t.set(r[0],new Set),t.has(r[1])||t.set(r[1],new Set),t.get(r[0]).add(r[1])}return t}function S(e){const t=new Map;for(let n=0,s=e.length;n<s;n++)t.set(e[n],n);return t}function v(e){let t,n,s=!1;for(const r of e.nodes)if(t||r.type!=="word")if(!t||s||r.type!=="div"||r.value!==","){if(s&&Array.isArray(n))n.push(r);else if(r.type!=="space"&&(r.type!=="div"||r.value.trim()!==""))return}else s=!0,n=[];else t=r;if(t)return{name:t,fallback:n}}function L(e,t){return e.nodes?.length?(O(e.nodes,(n,s,r)=>{if(!w(n))return;const o=v(n);if(!o)return;let c=!1;o.fallback&&m.walk(o.fallback,i=>{if(!w(i))return;const a=v(i);return a?a.fallback||t.has(a.name.value)?void 0:(c=!0,!1):void 0});let l=t.get(o.name.value)?.nodes;l||!o.fallback||c||(l=o.fallback),l!==void 0&&(l.length?r.splice(s,1,...l):r.splice(s,1,{type:"div",value:" ",before:"",after:"",sourceIndex:n.sourceIndex,sourceEndIndex:n.sourceEndIndex}))}),m.stringify(e.nodes)):""}function O(e,t){let n,s,r;for(n=0,s=e.length;n<s;n+=1)r=e[n],r.type==="function"&&Array.isArray(r.nodes)&&O(r.nodes,t),t(r,n,e),s=e.length}const K=/^initial$/i;function Q(e){const t=e.nodes.filter(n=>n.type!=="comment"&&n.type!=="space");return t.length===1&&t[0].type==="word"&&K.test(t[0].value)}function E(e,t,n){if(!e.size)return t;const s=new Map(t);{const r=[];for(const[o,c]of e.entries()){const l=b(c,n);let i=!1;m.walk(l.nodes,a=>{if(!w(a))return;const u=v(a);u&&(u.fallback||e.has(u.name.value)||t.has(u.name.value)?r.push([u.name.value,o]):i=!0)}),i||s.set(o,l)}U(s,r)}{const r=[];for(const[c,l]of s.entries())m.walk(l.nodes,i=>{if(!w(i))return;const a=v(i);a&&(a.fallback||s.has(a.name.value)?r.push([a.name.value,c]):s.delete(c))});for(let c=0;c<r.length;c++){const[l,i]=r[c];s.has(l)&&s.has(i)||r.splice(c--,1)}const o=q(Array.from(s.keys()),r);for(const c of o){const l=s.get(c);if(!l)continue;const i=b(L(l,s),n);s.set(c,i)}}for(const[r,o]of s.entries())Q(o)&&s.delete(r);return s}function X(e,t){const n=new Map,s=new Map,r=P(e);return e.walkRules(o=>{W.test(o.selector)&&o.nodes?.length&&z(o)&&(M(o)||o.selectors.forEach(c=>{let l=-1;if(B.test(c)||V.test(c))l=0;else if(j.test(c))l=1;else{if(!D.test(c))return;l=2}const i=(u=r,((a=o).parent&&a.parent.type==="atrule"&&a.parent.name.toLowerCase()==="layer"?u.has(a.parent)?u.get(a.parent)+1:0:1e7)+10+l);var a,u;o.each(f=>{if(f.type!=="decl"||!f.variable||y(f)||f.value.toLowerCase().trim()==="initial")return;const d=s.get(f.prop)??-1;i>=d&&(s.set(f.prop,i),n.set(f.prop,f.value))})}))}),E(n,new Map,t)}function Y(e,t,n){if(!e.parent)return t;const s=new Map;return e.parent.each(r=>{r.type==="decl"&&r.variable&&e!==r&&(y(r)||s.set(r.prop,r.value))}),s.size?E(s,t,n):t}function Z(e,t,n){if(_(e)&&!y(e)){const s=e.raws?.value?.raw??e.value,r=L(m(s),t);if(r===s)return;if(ee(e,r))return void(n.preserve||e.remove());const o=e.cloneBefore({value:r});o.raws?.value?.raw&&(o.raws.value.raw=""),n?.preserve||e.remove()}}const _=e=>!e.variable&&e.value.includes("--")&&e.value.toLowerCase().includes("var(");function ee(e,t){if(!e||!e.parent)return!1;let n=!1;const s=e.parent.index(e);return e.parent.each((r,o)=>r!==e&&!(o>=s)&&void(r.type==="decl"&&r.prop.toLowerCase()===e.prop.toLowerCase()&&r.value===t&&(n=!0))),n}const te=/\bvar\(|\(top: var\(--f\)/i,re=e=>{const t=!("preserve"in Object(e))||!!e?.preserve;if("importFrom"in Object(e))throw new Error('[postcss-custom-properties] "importFrom" is no longer supported');if("exportTo"in Object(e))throw new Error('[postcss-custom-properties] "exportTo" is no longer supported');return{postcssPlugin:"postcss-custom-properties",prepare(){let n=new Map;const s=new WeakMap,r=new Map;return{postcssPlugin:"postcss-custom-properties",Once(o){n=X(o,r)},Declaration(o){if(!J.test(o.value)||I(o,te))return;let c=n;t&&o.parent&&(c=s.get(o.parent)??Y(o,n,r),s.set(o.parent,c)),Z(o,c,{preserve:t})}}}}};re.postcss=!0;export{re as c};
